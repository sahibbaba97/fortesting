{
	"name": "df_Descarga_Ficheros_Externos_01_CUADRO DATOS TIENDAS",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_DL_Files_excel_Cuadro_Datos_tienda",
						"type": "DatasetReference"
					},
					"name": "CuadroDatosTiendasRetail"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DS_BISTG_Cuadro_Tiendas_Retail",
						"type": "DatasetReference"
					},
					"name": "SinkCuadroDatosTiendasRetail",
					"description": "EXT_FichadasProbadas"
				}
			],
			"transformations": [
				{
					"name": "derivedColumn1"
				},
				{
					"name": "filter1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          {ID TIPO N0} as string,",
				"          DS_TIPO_N0 as string,",
				"          {ID TIPO N1} as string,",
				"          DS_TIPO_N1 as string,",
				"          {ID TIPO N2} as string,",
				"          DS_TIPO_N2 as string,",
				"          {ID TIPO N3} as string,",
				"          DS_TIPO_N3 as string,",
				"          ID_N1 as string,",
				"          {ZONA N1} as string,",
				"          ID_N2 as string,",
				"          {ZONA N2} as string,",
				"          ID_N4 as string,",
				"          {PAIS N4} as string,",
				"          ID_N5 as string,",
				"          {ZONA N5} as string,",
				"          ID_N6 as string,",
				"          {ZONA N6 CIUDAD} as string,",
				"          {TIENDAS PRONOVIAS} as string,",
				"          {ID_Area Manager} as string,",
				"          {AREA MANAGER} as string,",
				"          Id_directora as string,",
				"          directora as string,",
				"          {ID TPV} as string,",
				"          {ID MVX} as string,",
				"          {ESTADO TIENDA} as string,",
				"          {FECHA APERTURA PUBLICO} as string,",
				"          {FECHA CIERRE PUBLICO} as string,",
				"          {AÑO REFORMA} as string,",
				"          SUPERFICIE as string,",
				"          {Nº PLANTAS TIENDA} as string,",
				"          {S. VENTA} as string,",
				"          {S. ALMACÉN} as string,",
				"          {ALM. EXT. O RESERVA} as string,",
				"          {Nº PROB.} as string,",
				"          {REP.M2 VENTA / PROB} as string,",
				"          {Nº PROB EN USO} as string,",
				"          {Nº MESAS DE INFORMACION} as string,",
				"          {ML CUELGA} as string,",
				"          {Nº ESCAPARATES} as string,",
				"          {Nº ASESORAS} as string,",
				"          {ASESORA 1} as string,",
				"          {ASESORA 2} as string,",
				"          {ASESORA 3} as string,",
				"          {ASESORA 4} as string,",
				"          {FECHA PREVISTA APERTURA} as string,",
				"          {FECHA PREVISTA CIERRE} as string,",
				"          {FECHA 1º ACTIVIDAD} as string,",
				"          {FECHA CIERRE ACTIVIDAD} as string,",
				"          {TC TEMP ANT} as string,",
				"          {TC TEM ACT} as string,",
				"          {E-MAIL (1)} as string,",
				"          {E-MAIL (2)} as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> CuadroDatosTiendasRetail",
				"filter1 derive({TC TEMP ANT} = toDecimal({TC TEM ACT},10,4),",
				"          {TC TEM ACT} = toDecimal({TC TEM ACT},10,4)) ~> derivedColumn1",
				"CuadroDatosTiendasRetail filter(not(isNull({ID TPV})) || not(isNull({ID MVX}))) ~> filter1",
				"derivedColumn1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          SUPERFICIE as string,",
				"          S_VENTA as string,",
				"          {S_ALMACÉN} as string,",
				"          ALM_EXT_RESERVA as string,",
				"          N_PROB as string,",
				"          N_PROBENUSO as string,",
				"          N_MESASINFORMACION as string,",
				"          ML_CUELGA as string,",
				"          ZONA_N4_PAIS as string,",
				"          ZONA_N1 as string,",
				"          ZONA_N2 as string,",
				"          {AREA MANAGER} as string,",
				"          ZONA_N3 as string,",
				"          TIENDAS_PRONOVIAS as string,",
				"          ID_TPV as string,",
				"          ID_MVX as string,",
				"          ESTADO_TIENDA as string,",
				"          FECHA_APERTURA_PUBLICO as string,",
				"          FECHA_CIERRE_PUBLICO as string,",
				"          ANO_REFORMA as string,",
				"          N_PLANTAS_TIENDA as string,",
				"          REP_M2_VENTA_PROB as string,",
				"          DIRECTORA as string,",
				"          N_ASESORAS as string,",
				"          ASESORA_1 as string,",
				"          ASESORA_2 as string,",
				"          ASESORA_3 as string,",
				"          ASESORA_4 as string,",
				"          FECHA_PREVISTA_APERTURA as string,",
				"          FECHA_PREVISTA_CIERRE as string,",
				"          FECHA_1_ACTIVIDAD as string,",
				"          FECHA_CIERRE_ACTIVIDAD as string,",
				"          ZONA_N5 as string,",
				"          ZONA_N6 as string,",
				"          ID_ZONA_N1 as string,",
				"          ID_ZONA_N2 as string,",
				"          ID_ZONA_N3 as string,",
				"          ID_ZONA_N4 as string,",
				"          ID_ZONA_N5 as string,",
				"          ID_ZONA_N6 as string,",
				"          ID_DIRECTORA as string,",
				"          ID_AREAMANAGER as string,",
				"          ID_TIPO_N0 as string,",
				"          ID_TIPO_N1 as string,",
				"          ID_TIPO_N2 as string,",
				"          ID_TIPO_N3 as string,",
				"          DS_TIPO_N0 as string,",
				"          DS_TIPO_N1 as string,",
				"          DS_TIPO_N2 as string,",
				"          DS_TIPO_N3 as string,",
				"          NUM_TC_ACTUAL as decimal(10,4),",
				"          NUM_TC_ANTERIOR as decimal(10,4),",
				"          EMAIL_TIENDA as string,",
				"          EMAIL_SUPERVISORA as string",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     preSQLs:['Insert into CONTROL_Log_Carga (Dw_Proceso, Dw_Descripcion, Dw_Paso, Dw_Fecha)\\nselect \\'DESCARGA_01_FICHEROSEXTERNOS\\', \\'Borrado Tabla EXT_Tiendas_CuadroRetail\\', \\'INI\\', getdate();\\n\\ntruncate table EXT_Tiendas_CuadroRetail;\\n\\nInsert into CONTROL_Log_Carga (Dw_Proceso, Dw_Descripcion, Dw_Paso, Dw_Fecha)\\nselect \\'DESCARGA_00_FICHEROSEXTERNOS\\', \\'Borrado Tabla EXT_Tiendas_CuadroRetail\\', \\'FIN\\', getdate();\\n\\nInsert into CONTROL_Log_Carga (Dw_Proceso, Dw_Descripcion, Dw_Paso, Dw_Fecha)\\nselect \\'DESCARGA_00_FICHEROSEXTERNOS\\', \\'Descarga Tabla EXT_Tiendas_CuadroRetail\\', \\'INI\\', getdate()\\n\\n'],",
				"     postSQLs:['Insert into CONTROL_Log_Carga (Dw_Proceso, Dw_Descripcion, Dw_Paso, Dw_Fecha)\\nselect \\'DESCARGA_01_FICHEROSEXTERNOS\\', \\'Descarga Tabla EXT_Tiendas_CuadroRetail\\', \\'FIN\\', getdate()'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          SUPERFICIE,",
				"          S_VENTA = {S. VENTA},",
				"          {S_ALMACÉN} = {S. ALMACÉN},",
				"          ALM_EXT_RESERVA = {ALM. EXT. O RESERVA},",
				"          N_PROB = {Nº PROB.},",
				"          N_PROBENUSO = {Nº PROB EN USO},",
				"          N_MESASINFORMACION = {Nº MESAS DE INFORMACION},",
				"          ML_CUELGA = {ML CUELGA},",
				"          ZONA_N1 = {ZONA N1},",
				"          ZONA_N2 = {ZONA N2},",
				"          {AREA MANAGER},",
				"          TIENDAS_PRONOVIAS = {TIENDAS PRONOVIAS},",
				"          ID_TPV = {ID TPV},",
				"          ID_MVX = {ID MVX},",
				"          ESTADO_TIENDA = {ESTADO TIENDA},",
				"          FECHA_APERTURA_PUBLICO = {FECHA APERTURA PUBLICO},",
				"          FECHA_CIERRE_PUBLICO = {FECHA CIERRE PUBLICO},",
				"          ANO_REFORMA = {AÑO REFORMA},",
				"          N_PLANTAS_TIENDA = {Nº PLANTAS TIENDA},",
				"          REP_M2_VENTA_PROB = {REP.M2 VENTA / PROB},",
				"          DIRECTORA = directora,",
				"          N_ASESORAS = {Nº ASESORAS},",
				"          ASESORA_1 = {ASESORA 1},",
				"          ASESORA_2 = {ASESORA 2},",
				"          ASESORA_3 = {ASESORA 3},",
				"          ASESORA_4 = {ASESORA 4},",
				"          FECHA_PREVISTA_APERTURA = {FECHA PREVISTA APERTURA},",
				"          FECHA_PREVISTA_CIERRE = {FECHA PREVISTA CIERRE},",
				"          FECHA_1_ACTIVIDAD = {FECHA 1º ACTIVIDAD},",
				"          FECHA_CIERRE_ACTIVIDAD = {FECHA CIERRE ACTIVIDAD},",
				"          ZONA_N4_PAIS = {PAIS N4},",
				"          ZONA_N5 = {ZONA N5},",
				"          ZONA_N6 = {ZONA N6 CIUDAD},",
				"          ID_ZONA_N1 = ID_N1,",
				"          ID_ZONA_N2 = ID_N2,",
				"          ID_ZONA_N4 = ID_N4,",
				"          ID_ZONA_N5 = ID_N5,",
				"          ID_ZONA_N6 = ID_N6,",
				"          ID_DIRECTORA = Id_directora,",
				"          ID_AREAMANAGER = {ID_Area Manager},",
				"          ID_TIPO_N0 = {ID TIPO N0},",
				"          ID_TIPO_N1 = {ID TIPO N1},",
				"          ID_TIPO_N2 = {ID TIPO N2},",
				"          ID_TIPO_N3 = {ID TIPO N3},",
				"          DS_TIPO_N0,",
				"          DS_TIPO_N1,",
				"          DS_TIPO_N2,",
				"          DS_TIPO_N3,",
				"          NUM_TC_ACTUAL = {TC TEM ACT},",
				"          NUM_TC_ANTERIOR = {TC TEMP ANT},",
				"          EMAIL_TIENDA = {E-MAIL (1)},",
				"          EMAIL_SUPERVISORA = {E-MAIL (2)}",
				"     )) ~> SinkCuadroDatosTiendasRetail"
			]
		}
	}
}